{% extends "base.html" %}
{% block content %}

<h3 class="fw-bold mb-4"
    style="background:linear-gradient(90deg,#7f5af0,#00f5ff);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;">
    ðŸš€ Improve Your Technical Skills
</h3>

<!-- ================= LANGUAGE + LEVEL SELECTION ================= -->
<form method="POST" class="mb-4">
  <div class="row g-2">

    <!-- Language -->
    <div class="col-md-4">
      <select name="language" class="form-select" required>
        <option value="">Select Programming Language</option>
        <option value="Python">Python</option>
        <option value="Java">Java</option>
        <option value="JavaScript">JavaScript</option>
        <option value="C++ (plus plus)">C++</option>
        <option value="structured query language">SQL</option>
        <option value="C# (sharp)">C#</option>
        <option value="Rust">Rust</option>
        <option value="Typescript">Typescript</option>
        <option value="Bash">Bash</option>
        <option value="php">Php</option>
        <option value="Swift">Swift</option>
        <option value="Kotlin">Kotlin</option>
        <option value="GD-Script">GD-Script</option>
        <option value="Lua">Lua</option>
        <option value="R Language">R</option>
        <option value="Flutter">Flutter</option>
      </select>
    </div>

    <!-- Difficulty Level -->
    <div class="col-md-4">
      <select name="difficulty" class="form-select" required>
        <option value="">Select Difficulty Level</option>
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
      </select>
    </div>

    <!-- Generate Button -->
    <div class="col-md-4">
      <button class="btn btn-primary w-100">
        Generate Quiz
      </button>
    </div>

  </div>
</form>


<!-- ================= QUIZ DISPLAY ================= -->
{% if questions %}
<form method="POST">

  <input type="hidden" name="submit_quiz" value="1">
  <input type="hidden" name="total_questions" value="{{ questions|length }}">
  <input type="hidden" name="language" value="{{ selected_language }}">
  <input type="hidden" name="difficulty" value="{{ selected_difficulty }}">

  {% for question in questions %}
  <div class="glass-card p-4 mb-3">
    <div class="card-body">

      <h6 class="fw-bold"
          style="background:linear-gradient(90deg,#7f5af0,#00f5ff);
          -webkit-background-clip:text;
          -webkit-text-fill-color:transparent;">
        Q{{ loop.index }}. {{ question.question }}
      </h6>

      {% set q_index = loop.index0 %}

      {% for option in question.options %}
      <div class="form-check">
        <input class="form-check-input"
               type="radio"
               name="user_answer_{{ q_index }}"
               value="{{ ['A','B','C','D'][loop.index0] }}"
               required>

        <label class="form-check-label">
          {{ ['A','B','C','D'][loop.index0] }}. {{ option }}
        </label>
      </div>
      {% endfor %}

      <!-- Store correct answer -->
      <input type="hidden"
             name="correct_answer_{{ q_index }}"
             value="{{ question.answer }}">

    </div>
  </div>
  {% endfor %}

  <button class="btn btn-success w-100">
    Submit Quiz
  </button>

</form>
{% endif %}


{% if score is not none %}
<div class="alert alert-success mt-4 text-center">
  ðŸŽ¯ Your Score: <strong>{{ score }}%</strong>
</div>
{% endif %}

{% endblock %}
